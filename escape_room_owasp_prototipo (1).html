<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escape Room OWASP - Principiantes</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f3f4f6; margin: 0; padding: 2rem; }
    .room { display: none; padding: 2rem; background: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .room.active { display: block; }
    button { background: #3b82f6; color: white; padding: 0.5rem 1rem; border: none; border-radius: 5px; cursor: pointer; }
    .question { font-weight: bold; margin-bottom: 1rem; }
    .code-block { background: #f0f0f0; padding: 1rem; border-radius: 5px; font-family: monospace; white-space: pre-wrap; margin-bottom: 1rem; }
    .options label { display: block; margin-bottom: 0.5rem; }
    .feedback { margin-top: 1rem; font-weight: bold; }
  </style>
</head>
<body>

  <h1>Escape Room: OWASP Top 10 para Principiantes</h1>
  <div id="rooms"></div>

  <script>
    const rooms = [
      {
        title: "Sala 1: Broken Access Control",
        question: "¿Cuál de estos sería un ejemplo de acceso no autorizado?",
        options: [
          { text: "A) Ver tu perfil", correct: false },
          { text: "B) Acceder al perfil de otro usuario sin permiso", correct: true },
          { text: "C) Cambiar tu contraseña", correct: false }
        ]
      },
      {
        title: "Sala 2: Cryptographic Failures",
        question: "¿Cuál es una mala práctica con contraseñas?",
        options: [
          { text: "A) Guardarlas cifradas", correct: false },
          { text: "B) Escribirlas en papel", correct: false },
          { text: "C) Guardarlas como texto normal en una base de datos", correct: true }
        ]
      },
      {
        title: "Sala 3: Injection",
        question: "¿Qué significa 'inyección' en seguridad informática?",
        options: [
          { text: "A) Inyectarse medicina", correct: false },
          { text: "B) Que el usuario mete código malicioso en un formulario", correct: true },
          { text: "C) Copiar código", correct: false }
        ]
      },
      {
        title: "Sala 4: Security Misconfiguration",
        question: "¿Qué puede ser una mala configuración?",
        options: [
          { text: "A) Activar protección contra clics maliciosos", correct: false },
          { text: "B) Dejar páginas administrativas sin contraseña", correct: true },
          { text: "C) Usar solo HTTPS", correct: false }
        ]
      },
      {
        title: "Sala 5: Vulnerable and Outdated Components",
        question: "¿Qué deberíamos hacer con las librerías de código?",
        options: [
          { text: "A) Nunca actualizarlas", correct: false },
          { text: "B) Usar las versiones más antiguas porque pesan menos", correct: false },
          { text: "C) Revisar que estén actualizadas y sin fallos", correct: true }
        ]
      },
      {
        title: "Sala 6: Security Logging and Monitoring Failures",
        question: "¿Por qué es importante registrar los intentos de acceso?",
        options: [
          { text: "A) Para ver quién entra y detectar ataques", correct: true },
          { text: "B) Para ocupar más espacio", correct: false },
          { text: "C) Para hacer más lento el sistema", correct: false }
        ]
      },
      {
        title: "Sala Final: Desafío Combinado",
        question: "¿Qué vulnerabilidad tiene este código?",
        code: "public string VerUsuario(string nombre) {\n    string consulta = \"SELECT * FROM Usuarios WHERE nombre = '\" + nombre + \"'\";\n    return Ejecutar(consulta);\n} // Pista: cuidado con los datos que vienen del usuario.",
        options: [
          { text: "A) Está bien como está", correct: false },
          { text: "B) Tiene una inyección SQL", correct: true },
          { text: "C) La variable no está declarada", correct: false }
        ]
      }
    ];

    const container = document.getElementById('rooms');

    rooms.forEach((room, index) => {
      const div = document.createElement('div');
      div.className = 'room' + (index === 0 ? ' active' : '');

      const title = document.createElement('h2');
      title.textContent = room.title;
      div.appendChild(title);

      const question = document.createElement('div');
      question.className = 'question';
      question.textContent = room.question;
      div.appendChild(question);

      if (room.code) {
        const code = document.createElement('div');
        code.className = 'code-block';
        code.textContent = room.code;
        div.appendChild(code);
      }

      const options = document.createElement('div');
      options.className = 'options';

      room.options.forEach(option => {
        const label = document.createElement('label');
        const input = document.createElement('input');
        input.type = 'radio';
        input.name = 'room-' + index;
        input.onclick = () => checkAnswer(option.correct, index);
        label.appendChild(input);
        label.appendChild(document.createTextNode(option.text));
        options.appendChild(label);
      });

      div.appendChild(options);

      const feedback = document.createElement('div');
      feedback.className = 'feedback';
      div.appendChild(feedback);

      container.appendChild(div);
    });

    function checkAnswer(correct, index) {
      const feedback = document.querySelectorAll('.feedback')[index];
      if (correct) {
        feedback.textContent = '✅ ¡Correcto! Avanzando a la siguiente sala...';
        setTimeout(() => {
          document.querySelectorAll('.room')[index].classList.remove('active');
          if (index + 1 < rooms.length) {
            document.querySelectorAll('.room')[index + 1].classList.add('active');
          } else {
            alert('🎉 ¡Felicidades! Has completado el Escape Room OWASP.');
          }
        }, 1000);
      } else {
        feedback.textContent = '❌ Incorrecto. Intenta de nuevo.';
      }
    }
  </script>
</body>
</html>
